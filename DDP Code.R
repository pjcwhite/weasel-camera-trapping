#Load packages in R and import data
library("lme4")
library("Matrix")
ddp<-read.csv(file=file.choose(),stringsAsFactors=TRUE)

#Calculate DDP for all sites
cbind(ddp$capture,ddp$noncapture)
glm(formula=cbind(ddp$capture,ddp$noncapture)~1,family="binomial")
exp(x=-5.076)/(1+exp(x=-5.076))
summary(object=glm(formula=cbind(ddp$capture,ddp$noncapture)~1,family="binomial"))
exp(x=-5.0757-0.1158)/(1+exp(x=-5.0757-0.1158))
exp(x=-5.0757+0.1158)/(1+exp(x=-5.0757+0.1158))
1-(1-0.006206082)^60

#Create GLMM and analyze DDP & P60 for bait and lure vs. none
fmodelbl<-glm(cbind(capture,noncapture)~baitlure,data=ddp,family="binomial")
rmodelbl<-glmer(cbind(capture,noncapture)~baitlure+(1|site),data=ddp,family="binomial")
anova(fmodelbl,rmodelbl,test="Chi")
null.model<-glmer(cbind(capture,noncapture)~1+(1|site),data=ddp,family="binomial")
anova(rmodelbl,null.model,test="Chi")
summary(rmodelbl)
exp(x=-6.6166)/(1+exp(x=-6.6166))
exp(x=-5.6383)/(1+exp(x=-5.6383))
1-(1-0.001336185)^60 
1-(1-0.003546292)^60
exp(x=-6.6166-0.5629)/(1+exp(x=-6.6166-0.5629))
exp(x=-6.6166+0.5629)/(1+exp(x=-6.6166+0.5629))
1-(1-0.0007614685)^60 
1-(1-0.002343653)^60 
exp(x=-5.6383-0.6338)/(1+exp(x=-5.6383-0.6338))
exp(x=-5.6383+0.6338)/(1+exp(x=-5.6383+0.6338))
1-(1-0.0018847)^60
1-(1-0.006663001)^60

#Create GLMM and analyze DDP & P60 for two bait types vs. none
fmodelbt<-glm(cbind(capture,noncapture)~baittype,data=ddp,family="binomial")
rmodelbt<-glmer(cbind(capture,noncapture)~baittype+(1|site),data=ddp,family="binomial")
anova(fmodelbt,rmodelbt,test="Chi")
anova(rmodelbt,null.model,test="Chi")
summary(rmodelbt)
exp(x=-6.6100)/(1+exp(x=-6.6100))
exp(x=-5.4432)/(1+exp(x=-5.4432))
exp(x=-5.7663)/(1+exp(x=-5.7663))
1-(1-0.001345021)^60 
1-(1-0.004306989)^60
1-(1-0.003121547)^60
exp(x=-6.6100-0.5601)/(1+exp(x=-6.6100-0.5601))
exp(x=-6.6100+0.5601)/(1+exp(x=-6.6100+0.5601))
1-(1-0.0007686545)^60 
1-(1-0.00235255)^60 
exp(x=-5.4432-0.6465)/(1+exp(x=-5.4432-0.6465))
exp(x=-5.4432+0.6465)/(1+exp(x=-5.4432+0.6465))
1-(1-0.002260965)^60
1-(1-0.008189331)^60
exp(x=-5.7663-0.6415)/(1+exp(x=-5.7663-0.6415))
exp(x=-5.7663+0.6415)/(1+exp(x=-5.7663+0.6415))
1-(1-0.001645934)^60
1-(1-0.005912244)^60

#Create GLMM and analyze DDP & P60 for three lure types vs. none
fmodellt<-glm(cbind(capture,noncapture)~luretype,data=ddp,family="binomial")
rmodellt<-glmer(cbind(capture,noncapture)~luretype+(1|site),data=ddp,family="binomial")
anova(fmodellt,rmodellt,test="Chi")
anova(rmodellt,null.model,test="Chi")
summary(rmodellt)
exp(x=-6.6231)/(1+exp(x=-6.6231))
exp(x=-6.4537)/(1+exp(x=-6.4537))
exp(x=-5.1384)/(1+exp(x=-5.1384))
exp(x=-5.7157)/(1+exp(x=-5.7157))
1-(1-0.001327539)^60 
1-(1-0.001572209)^60
1-(1-0.005832848)^60
1-(1-0.00328303)^60
exp(x=-6.6231-0.5657)/(1+exp(x=-6.6231-0.5657))
exp(x=-6.623+0.5657)/(1+exp(x=-6.623+0.5657))
1-(1-0.000754425)^60 
1-(1-0.002335246)^60 
exp(x=-6.4537-0.7021)/(1+exp(x=-6.4537-0.7021))
exp(x=-6.4537+0.7021)/(1+exp(x=-6.4537+0.7021))
1-(1-0.0007797166)^60
1-(1-0.003167627)^60
exp(x=-5.1384-0.6486)/(1+exp(x=-5.1384-0.6486))
exp(x=-5.1384+0.6486)/(1+exp(x=-5.1384+0.6486))
1-(1-0.003057791)^60
1-(1-0.01109833)^60
exp(x=-5.7157-0.6632)/(1+exp(x=-5.7157-0.6632))
exp(x=-5.7157+0.6632)/(1+exp(x=-5.7157+0.6632))
1-(1-0.001694114)^60
1-(1-0.006352715)^60

#Create GLMM and analyze DDP & P60 for Kill Squeak vs. none
fmodelks<-glm(cbind(capture,noncapture)~KS,data=ddp,family="binomial")
rmodelks<-glmer(cbind(capture,noncapture)~KS+(1|site),data=ddp,family="binomial")
anova(fmodelks,rmodelks,test="Chi")
anova(rmodelks,null.model,test="Chi")
summary(rmodelks)
exp(x=-5.8315)/(1+exp(x=-5.8315))
exp(x=-6.7665)/(1+exp(x=-6.7665))
1-(1-0.002925092)^60 
1-(1-0.001150394)^60
exp(x=-5.8315-0.3406)/(1+exp(x=-5.8315-0.3406))
exp(x=-5.8315+0.3406)/(1+exp(x=-5.8315+0.3406))
1-(1-0.002082503)^60 
1-(1-0.004107192)^60 
exp(x=-6.7665-0.3771)/(1+exp(x=-6.7665-0.3771))
exp(x=-6.7665+0.3771)/(1+exp(x=-6.7665+0.3771))
1-(1-0.0007892799)^60
1-(1-0.001676448)^60

#Create GLM and analyze DDP & P60 for six combinations of baits and lures vs. none
fmodelblt<-glm(cbind(capture,noncapture)~baitluretype,data=ddp,family="binomial")
rmodelblt<-glmer(cbind(capture,noncapture)~baitluretype+(1|site),data=ddp,family="binomial")
anova(fmodelblt,rmodelblts,test="Chi")
anova(rmodelblt,null.model,test="Chi")
summary(rmodelblt)
exp(x=-6.5818)/(1+exp(x=-6.5818))
1-(1-0.001383437)^60
exp(x=-6.5818-0.5484)/(1+exp(x=-6.5818-0.5484))
exp(x=-6.5818+0.5484)/(1+exp(x=-6.5818+0.5484))
1-(1-0.0007999189)^60 
1-(1-0.002391596)^60 
exp(x=-6.2615)/(1+exp(x=-6.2615))
1-(1-0.001904746)^60
exp(x=-6.2615-0.7792)/(1+exp(x=-6.2615-0.7792))
exp(x=-6.2615+0.7792)/(1+exp(x=-6.2615+0.7792))
1-(1-0.0008747476)^60 
1-(1-0.004142519)^60 
exp(x=-4.5153)/(1+exp(x=-4.5153))
1-(1-0.01082193)^60
exp(x=-4.5153-0.6771)/(1+exp(x=-4.5153-0.6771))
exp(x=-4.5153+0.6771)/(1+exp(x=-4.5153+0.6771))
1-(1-0.005527922)^60 
1-(1-0.02107846)^60 
exp(x=-5.1141)/(1+exp(x=-5.1141))
1-(1-0.005975465)^60
exp(x=-5.1141-0.8187)/(1+exp(x=-5.1141-0.8187))
exp(x=-5.1141+0.8187)/(1+exp(x=-5.1141+0.8187))
1-(1-0.002644039)^60 
1-(1-0.01344781)^60 
exp(x=-6.3563)/(1+exp(x=-6.3563))
1-(1-0.00173277)^60
exp(x=-6.3563-0.7560)/(1+exp(x=-6.3563-0.7560))
exp(x=-6.3563+0.7560)/(1+exp(x=-6.3563+0.7560))
1-(1-0.0008143546)^60 
1-(1-0.003683139)^60 
exp(x=-5.649)/(1+exp(x=-5.649))
1-(1-0.003508682)^60
exp(x=-5.649-0.6916)/(1+exp(x=-5.649-0.6916))
exp(x=-5.649+0.6916)/(1+exp(x=-5.649+0.6916))
1-(1-0.00176014)^60 
1-(1-0.006982093)^60 
exp(x=-5.3985)/(1+exp(x=-5.3985))
1-(1-0.004502992)^60
exp(x=-5.3985-0.6709)/(1+exp(x=-5.3985-0.6709))
exp(x=-5.3985+0.6709)/(1+exp(x=-5.3985+0.6709))
1-(1-0.002307225)^60 
1-(1-0.008770085)^60 

#Create GLMM and analyze DDP & P60 for three combinations of Kill Squeak use vs. none
fmodelblk<-glm(cbind(capture,noncapture)~baitlure+KS+baitlure:KS,data=ddp,family="binomial")
rmodelblk<-glmer(cbind(capture,noncapture)~baitlure+KS+baitlure:KS+(1|site),data=ddp,family="binomial")
anova(fmodelblk,rmodelblk,test="Chi")
anova(rmodelblk,null.model,test="Chi")
summary(rmodelblk)
exp(x=-6.3625)/(1+exp(x=-6.3625))
exp(x=-5.5448)/(1+exp(x=-5.5448))
exp(x=-7.8117)/(1+exp(x=-7.8117))
exp(x=-6.3557)/(1+exp(x=-6.3557))
1-(1-0.001722078)^60 
1-(1-0.003892514)^60
1-(1-0.0004048051)^60
1-(1-0.001733808)^60
exp(x=-6.3625-0.5812)/(1+exp(x=-6.3625-0.5812))
exp(x=-6.3625+0.5812)/(1+exp(x=-6.3625+0.5812))
1-(1-0.0009637639)^60 
1-(1-0.003075217)^60 
exp(x=-5.5448-0.6546)/(1+exp(x=-5.5448-0.6546))
exp(x=-5.5448+0.6546)/(1+exp(x=-5.5448+0.6546))
1-(1-0.002026533)^60
1-(1-0.007463791)^60
exp(x=-7.8117-1.0568)/(1+exp(x=-7.8117-1.0568))
exp(x=-7.8117+1.0568)/(1+exp(x=-7.8117+1.0568))
1-(1-0.0001407338)^60
1-(1-0.0011638)^60
exp(x=-6.3557-1.1329)/(1+exp(x=-6.3557-1.1329))
exp(x=-6.3557+1.1329)/(1+exp(x=-6.3557+1.1329))
1-(1-0.0005591128)^60
1-(1-0.00536329)^60